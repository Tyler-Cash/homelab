drone:
  env:
    DRONE_SERVER_HOST: &host drone.k8s.tylercash.dev
    DRONE_SERVER_PROTO: &proto https
    DRONE_GIT_ALWAYS_AUTH: true
  extraSecretNamesForEnvFrom:
    - drone-secrets
  ingress:
    enabled: true
    annotations:
      external-dns.home.arpa/enabled: "true"
      external-dns.alpha.kubernetes.io/target: ingress.tylercash.dev
    hosts:
      - host: *host
        paths:
          - path: /
            pathType: Prefix
    tls:
    - secretName: drone-letsencrypt-certificate
      hosts:
      - *host
drone-runner-docker:
  nameOverride: "runner"

  dind:
    commandArgs:
      - "--host"
      - &docker_host "tcp://localhost:2375"

  env:
    DRONE_RPC_HOST: *host
    DRONE_RPC_PROTO: *proto
    DOCKER_HOST: *docker_host
    DRONE_RUNNER_NETWORK_OPTS: "com.docker.network.driver.mtu:1430"
  
  extraSecretNamesForEnvFrom:
    - drone-secrets
  
  ingress:
    enabled: true
    hosts:
      - host: &runner_host runner.k8s.tylercash.dev
        paths:
          - path: /
            pathType: Prefix
    tls:
    - secretName: drone-runner-letsencrypt-certificate
      hosts:
      - *runner_host